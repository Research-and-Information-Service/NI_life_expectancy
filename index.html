
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>NI DEA Life Expectancy Map</title>

  <!-- Leaflet CSS -->
  https://unpkg.com/leaflet/dist/leaflet.css

  <style>
    body { margin:0; font-family: Arial, sans-serif; }
    #map { width: 100%; height: 100vh; }

    /* Sidebar slides in from the right */
    #sidebar {
      position: fixed; top:0; right:-340px; width:320px; height:100vh;
      background:#f9f9f9; border-left:1px solid #ccc; padding:12px; box-sizing:border-box;
      overflow-y:auto; z-index:1000; transition:right .25s ease;
    }
    #sidebar.open { right:0; }
    #close-sidebar {
      float:right; margin-left:8px; background:#0078d7; color:#fff; border:none;
      padding:6px 10px; cursor:pointer; border-radius:4px;
    }
    #sidebar-title { margin:0 0 10px; font-weight:600; }
    #chart-container { margin-top:8px; }
    canvas { width:100%; height:280px; }
  </style>
</head>
<body>

  <div id="map"></div>

  <!-- Sidebar (buttons removed) -->
  <div id="sidebar">
    <button id="close-sidebar">Close</button>
    <h3 id="sidebar-title">DEA details</h3>
    <div id="sidebar-meta"></div>
    <div id="chart-container"><canvas id="deaChart"></canvas></div>
  </div>

  <!-- Scripts (CDN) -->
  https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js</script>
  <script src="httpsleaflet/dist/leaflet.js</script>

  <script>
    // Map init
    const map = L.map('map').setView([54.6, -6.7], 8);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution:'&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Sidebar controls
    const sidebar = document.getElementById('sidebar');
    const titleEl  = document.getElementById('sidebar-title');
    const metaEl   = document.getElementById('sidebar-meta');
    document.getElementById('close-sidebar').onclick = () => sidebar.classList.remove('open');

    // Chart.js
    const ctx = document.getElementById('deaChart').getContext('2d');
    const deaChart = new Chart(ctx, {
      type: 'line',
      data: { labels: [], datasets: [] },
      options: { responsive:true, maintainAspectRatio:false }
    });

    // Placeholder GeoJSON; replace with your real file (see fetch below)
    const exampleGeoJSON = {
      "type": "FeatureCollection",
      "features": [{
        "type": "Feature",
        "properties": { "name": "Example DEA" },
        "geometry": { "type": "Polygon", "coordinates": [[
          [-6.7,54.6],[-6.6,54.6],[-6.6,54.7],[-6.7,54.7],[-6.7,54.6]
        ]]}
      }]
    };

    addLayer(exampleGeoJSON);

    // To load your real GeoJSON from the repo, place it next to index.html and use:
    // fetch('DEA.geojson')  // or 'data/DEA.geojson' (adjust relative path)
    //   .then(r => r.json())
    //   .then(addLayer)
    //   .catch(err => console.error('GeoJSON load failed:', err));

    function addLayer(geojson) {
      const layer = L.geoJSON(geojson, {
        style: { color:'#0078d7', weight:2, fillColor:'#66a3e0', fillOpacity:0.3 },
        onEachFeature: function(feature, leafletLayer) {
          leafletLayer.on('mouseover', () => openSidebar(feature));
          leafletLayer.on('click',     () => openSidebar(feature));
          leafletLayer.on('mouseout',  () => leafletLayer.setStyle({ weight:2, fillOpacity:0.3 }));
        }
      }).addTo(map);

      try { map.fitBounds(layer.getBounds(), { padding:[20,20] }); } catch (e) {}
    }

    function openSidebar(feature) {
      titleEl.textContent = feature?.properties?.name ?? 'DEA details';
      metaEl.innerHTML = `<p><strong>DEA:</strong> ${feature?.properties?.name ?? 'â€”'}</p>`;
      sidebar.classList.add('open');

      // Update chart (example data)
      deaChart.data.labels = ['2001','2006','2011','2016','2021'];
      deaChart.data.datasets = [{
        label:'Life Expectancy', data:[76.8,77.5,78.3,79.2,79.8],
        borderColor:'#0078d7', tension:0.25, fill:false
      }];
      deaChart.update();
    }
  </script>
</body>
</html>
